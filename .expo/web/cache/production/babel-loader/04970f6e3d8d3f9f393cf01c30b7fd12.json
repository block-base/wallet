{"ast":null,"code":"'use strict';var BN=require('bn.js');var inherits=require('inherits');var Base=require(\"./base\");var utils=require(\"../utils\");function MontCurve(conf){Base.call(this,'mont',conf);this.a=new BN(conf.a,16).toRed(this.red);this.b=new BN(conf.b,16).toRed(this.red);this.i4=new BN(4).toRed(this.red).redInvm();this.two=new BN(2).toRed(this.red);this.a24=this.i4.redMul(this.a.redAdd(this.two));}inherits(MontCurve,Base);module.exports=MontCurve;MontCurve.prototype.validate=function validate(point){var x=point.normalize().x;var x2=x.redSqr();var rhs=x2.redMul(x).redAdd(x2.redMul(this.a)).redAdd(x);var y=rhs.redSqrt();return y.redSqr().cmp(rhs)===0;};function Point(curve,x,z){Base.BasePoint.call(this,curve,'projective');if(x===null&&z===null){this.x=this.curve.one;this.z=this.curve.zero;}else{this.x=new BN(x,16);this.z=new BN(z,16);if(!this.x.red)this.x=this.x.toRed(this.curve.red);if(!this.z.red)this.z=this.z.toRed(this.curve.red);}}inherits(Point,Base.BasePoint);MontCurve.prototype.decodePoint=function decodePoint(bytes,enc){return this.point(utils.toArray(bytes,enc),1);};MontCurve.prototype.point=function point(x,z){return new Point(this,x,z);};MontCurve.prototype.pointFromJSON=function pointFromJSON(obj){return Point.fromJSON(this,obj);};Point.prototype.precompute=function precompute(){};Point.prototype._encode=function _encode(){return this.getX().toArray('be',this.curve.p.byteLength());};Point.fromJSON=function fromJSON(curve,obj){return new Point(curve,obj[0],obj[1]||curve.one);};Point.prototype.inspect=function inspect(){if(this.isInfinity())return'<EC Point Infinity>';return'<EC Point x: '+this.x.fromRed().toString(16,2)+' z: '+this.z.fromRed().toString(16,2)+'>';};Point.prototype.isInfinity=function isInfinity(){return this.z.cmpn(0)===0;};Point.prototype.dbl=function dbl(){var a=this.x.redAdd(this.z);var aa=a.redSqr();var b=this.x.redSub(this.z);var bb=b.redSqr();var c=aa.redSub(bb);var nx=aa.redMul(bb);var nz=c.redMul(bb.redAdd(this.curve.a24.redMul(c)));return this.curve.point(nx,nz);};Point.prototype.add=function add(){throw new Error('Not supported on Montgomery curve');};Point.prototype.diffAdd=function diffAdd(p,diff){var a=this.x.redAdd(this.z);var b=this.x.redSub(this.z);var c=p.x.redAdd(p.z);var d=p.x.redSub(p.z);var da=d.redMul(a);var cb=c.redMul(b);var nx=diff.z.redMul(da.redAdd(cb).redSqr());var nz=diff.x.redMul(da.redISub(cb).redSqr());return this.curve.point(nx,nz);};Point.prototype.mul=function mul(k){var t=k.clone();var a=this;var b=this.curve.point(null,null);var c=this;for(var bits=[];t.cmpn(0)!==0;t.iushrn(1)){bits.push(t.andln(1));}for(var i=bits.length-1;i>=0;i--){if(bits[i]===0){a=a.diffAdd(b,c);b=b.dbl();}else{b=a.diffAdd(b,c);a=a.dbl();}}return b;};Point.prototype.mulAdd=function mulAdd(){throw new Error('Not supported on Montgomery curve');};Point.prototype.jumlAdd=function jumlAdd(){throw new Error('Not supported on Montgomery curve');};Point.prototype.eq=function eq(other){return this.getX().cmp(other.getX())===0;};Point.prototype.normalize=function normalize(){this.x=this.x.redMul(this.z.redInvm());this.z=this.curve.one;return this;};Point.prototype.getX=function getX(){this.normalize();return this.x.fromRed();};","map":{"version":3,"sources":["/Users/naohirofujie/.anyenv/envs/nodenv/versions/14.5.0/lib/node_modules/expo-cli/node_modules/elliptic/lib/elliptic/curve/mont.js"],"names":["BN","require","inherits","Base","utils","MontCurve","conf","call","a","toRed","red","b","i4","redInvm","two","a24","redMul","redAdd","module","exports","prototype","validate","point","x","normalize","x2","redSqr","rhs","y","redSqrt","cmp","Point","curve","z","BasePoint","one","zero","decodePoint","bytes","enc","toArray","pointFromJSON","obj","fromJSON","precompute","_encode","getX","p","byteLength","inspect","isInfinity","fromRed","toString","cmpn","dbl","aa","redSub","bb","c","nx","nz","add","Error","diffAdd","diff","d","da","cb","redISub","mul","k","t","clone","bits","iushrn","push","andln","i","length","mulAdd","jumlAdd","eq","other"],"mappings":"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","sourcesContent":["'use strict';\n\nvar BN = require('bn.js');\nvar inherits = require('inherits');\nvar Base = require('./base');\n\nvar utils = require('../utils');\n\nfunction MontCurve(conf) {\n  Base.call(this, 'mont', conf);\n\n  this.a = new BN(conf.a, 16).toRed(this.red);\n  this.b = new BN(conf.b, 16).toRed(this.red);\n  this.i4 = new BN(4).toRed(this.red).redInvm();\n  this.two = new BN(2).toRed(this.red);\n  this.a24 = this.i4.redMul(this.a.redAdd(this.two));\n}\ninherits(MontCurve, Base);\nmodule.exports = MontCurve;\n\nMontCurve.prototype.validate = function validate(point) {\n  var x = point.normalize().x;\n  var x2 = x.redSqr();\n  var rhs = x2.redMul(x).redAdd(x2.redMul(this.a)).redAdd(x);\n  var y = rhs.redSqrt();\n\n  return y.redSqr().cmp(rhs) === 0;\n};\n\nfunction Point(curve, x, z) {\n  Base.BasePoint.call(this, curve, 'projective');\n  if (x === null && z === null) {\n    this.x = this.curve.one;\n    this.z = this.curve.zero;\n  } else {\n    this.x = new BN(x, 16);\n    this.z = new BN(z, 16);\n    if (!this.x.red)\n      this.x = this.x.toRed(this.curve.red);\n    if (!this.z.red)\n      this.z = this.z.toRed(this.curve.red);\n  }\n}\ninherits(Point, Base.BasePoint);\n\nMontCurve.prototype.decodePoint = function decodePoint(bytes, enc) {\n  return this.point(utils.toArray(bytes, enc), 1);\n};\n\nMontCurve.prototype.point = function point(x, z) {\n  return new Point(this, x, z);\n};\n\nMontCurve.prototype.pointFromJSON = function pointFromJSON(obj) {\n  return Point.fromJSON(this, obj);\n};\n\nPoint.prototype.precompute = function precompute() {\n  // No-op\n};\n\nPoint.prototype._encode = function _encode() {\n  return this.getX().toArray('be', this.curve.p.byteLength());\n};\n\nPoint.fromJSON = function fromJSON(curve, obj) {\n  return new Point(curve, obj[0], obj[1] || curve.one);\n};\n\nPoint.prototype.inspect = function inspect() {\n  if (this.isInfinity())\n    return '<EC Point Infinity>';\n  return '<EC Point x: ' + this.x.fromRed().toString(16, 2) +\n      ' z: ' + this.z.fromRed().toString(16, 2) + '>';\n};\n\nPoint.prototype.isInfinity = function isInfinity() {\n  // XXX This code assumes that zero is always zero in red\n  return this.z.cmpn(0) === 0;\n};\n\nPoint.prototype.dbl = function dbl() {\n  // http://hyperelliptic.org/EFD/g1p/auto-montgom-xz.html#doubling-dbl-1987-m-3\n  // 2M + 2S + 4A\n\n  // A = X1 + Z1\n  var a = this.x.redAdd(this.z);\n  // AA = A^2\n  var aa = a.redSqr();\n  // B = X1 - Z1\n  var b = this.x.redSub(this.z);\n  // BB = B^2\n  var bb = b.redSqr();\n  // C = AA - BB\n  var c = aa.redSub(bb);\n  // X3 = AA * BB\n  var nx = aa.redMul(bb);\n  // Z3 = C * (BB + A24 * C)\n  var nz = c.redMul(bb.redAdd(this.curve.a24.redMul(c)));\n  return this.curve.point(nx, nz);\n};\n\nPoint.prototype.add = function add() {\n  throw new Error('Not supported on Montgomery curve');\n};\n\nPoint.prototype.diffAdd = function diffAdd(p, diff) {\n  // http://hyperelliptic.org/EFD/g1p/auto-montgom-xz.html#diffadd-dadd-1987-m-3\n  // 4M + 2S + 6A\n\n  // A = X2 + Z2\n  var a = this.x.redAdd(this.z);\n  // B = X2 - Z2\n  var b = this.x.redSub(this.z);\n  // C = X3 + Z3\n  var c = p.x.redAdd(p.z);\n  // D = X3 - Z3\n  var d = p.x.redSub(p.z);\n  // DA = D * A\n  var da = d.redMul(a);\n  // CB = C * B\n  var cb = c.redMul(b);\n  // X5 = Z1 * (DA + CB)^2\n  var nx = diff.z.redMul(da.redAdd(cb).redSqr());\n  // Z5 = X1 * (DA - CB)^2\n  var nz = diff.x.redMul(da.redISub(cb).redSqr());\n  return this.curve.point(nx, nz);\n};\n\nPoint.prototype.mul = function mul(k) {\n  var t = k.clone();\n  var a = this; // (N / 2) * Q + Q\n  var b = this.curve.point(null, null); // (N / 2) * Q\n  var c = this; // Q\n\n  for (var bits = []; t.cmpn(0) !== 0; t.iushrn(1))\n    bits.push(t.andln(1));\n\n  for (var i = bits.length - 1; i >= 0; i--) {\n    if (bits[i] === 0) {\n      // N * Q + Q = ((N / 2) * Q + Q)) + (N / 2) * Q\n      a = a.diffAdd(b, c);\n      // N * Q = 2 * ((N / 2) * Q + Q))\n      b = b.dbl();\n    } else {\n      // N * Q = ((N / 2) * Q + Q) + ((N / 2) * Q)\n      b = a.diffAdd(b, c);\n      // N * Q + Q = 2 * ((N / 2) * Q + Q)\n      a = a.dbl();\n    }\n  }\n  return b;\n};\n\nPoint.prototype.mulAdd = function mulAdd() {\n  throw new Error('Not supported on Montgomery curve');\n};\n\nPoint.prototype.jumlAdd = function jumlAdd() {\n  throw new Error('Not supported on Montgomery curve');\n};\n\nPoint.prototype.eq = function eq(other) {\n  return this.getX().cmp(other.getX()) === 0;\n};\n\nPoint.prototype.normalize = function normalize() {\n  this.x = this.x.redMul(this.z.redInvm());\n  this.z = this.curve.one;\n  return this;\n};\n\nPoint.prototype.getX = function getX() {\n  // Normalize coordinates\n  this.normalize();\n\n  return this.x.fromRed();\n};\n"]},"metadata":{},"sourceType":"script"}