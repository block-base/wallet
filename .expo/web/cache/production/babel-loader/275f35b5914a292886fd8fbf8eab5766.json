{"ast":null,"code":"var Buffer=require('safe-buffer').Buffer;var checkParameters=require(\"./precondition\");var defaultEncoding=require(\"./default-encoding\");var sync=require(\"./sync\");var toBuffer=require(\"./to-buffer\");var ZERO_BUF;var subtle=global.crypto&&global.crypto.subtle;var toBrowser={sha:'SHA-1','sha-1':'SHA-1',sha1:'SHA-1',sha256:'SHA-256','sha-256':'SHA-256',sha384:'SHA-384','sha-384':'SHA-384','sha-512':'SHA-512',sha512:'SHA-512'};var checks=[];function checkNative(algo){if(global.process&&!global.process.browser){return Promise.resolve(false);}if(!subtle||!subtle.importKey||!subtle.deriveBits){return Promise.resolve(false);}if(checks[algo]!==undefined){return checks[algo];}ZERO_BUF=ZERO_BUF||Buffer.alloc(8);var prom=browserPbkdf2(ZERO_BUF,ZERO_BUF,10,128,algo).then(function(){return true;}).catch(function(){return false;});checks[algo]=prom;return prom;}function browserPbkdf2(password,salt,iterations,length,algo){return subtle.importKey('raw',password,{name:'PBKDF2'},false,['deriveBits']).then(function(key){return subtle.deriveBits({name:'PBKDF2',salt:salt,iterations:iterations,hash:{name:algo}},key,length<<3);}).then(function(res){return Buffer.from(res);});}function resolvePromise(promise,callback){promise.then(function(out){process.nextTick(function(){callback(null,out);});},function(e){process.nextTick(function(){callback(e);});});}module.exports=function(password,salt,iterations,keylen,digest,callback){if(typeof digest==='function'){callback=digest;digest=undefined;}digest=digest||'sha1';var algo=toBrowser[digest.toLowerCase()];if(!algo||typeof global.Promise!=='function'){return process.nextTick(function(){var out;try{out=sync(password,salt,iterations,keylen,digest);}catch(e){return callback(e);}callback(null,out);});}checkParameters(iterations,keylen);password=toBuffer(password,defaultEncoding,'Password');salt=toBuffer(salt,defaultEncoding,'Salt');if(typeof callback!=='function')throw new Error('No callback provided to pbkdf2');resolvePromise(checkNative(algo).then(function(resp){if(resp)return browserPbkdf2(password,salt,iterations,keylen,algo);return sync(password,salt,iterations,keylen,digest);}),callback);};","map":{"version":3,"sources":["/Users/naohirofujie/.anyenv/envs/nodenv/versions/14.5.0/lib/node_modules/expo-cli/node_modules/pbkdf2/lib/async.js"],"names":["Buffer","require","checkParameters","defaultEncoding","sync","toBuffer","ZERO_BUF","subtle","global","crypto","toBrowser","sha","sha1","sha256","sha384","sha512","checks","checkNative","algo","process","browser","Promise","resolve","importKey","deriveBits","undefined","alloc","prom","browserPbkdf2","then","catch","password","salt","iterations","length","name","key","hash","res","from","resolvePromise","promise","callback","out","nextTick","e","module","exports","keylen","digest","toLowerCase","Error","resp"],"mappings":"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","sourcesContent":["var Buffer = require('safe-buffer').Buffer\n\nvar checkParameters = require('./precondition')\nvar defaultEncoding = require('./default-encoding')\nvar sync = require('./sync')\nvar toBuffer = require('./to-buffer')\n\nvar ZERO_BUF\nvar subtle = global.crypto && global.crypto.subtle\nvar toBrowser = {\n  sha: 'SHA-1',\n  'sha-1': 'SHA-1',\n  sha1: 'SHA-1',\n  sha256: 'SHA-256',\n  'sha-256': 'SHA-256',\n  sha384: 'SHA-384',\n  'sha-384': 'SHA-384',\n  'sha-512': 'SHA-512',\n  sha512: 'SHA-512'\n}\nvar checks = []\nfunction checkNative (algo) {\n  if (global.process && !global.process.browser) {\n    return Promise.resolve(false)\n  }\n  if (!subtle || !subtle.importKey || !subtle.deriveBits) {\n    return Promise.resolve(false)\n  }\n  if (checks[algo] !== undefined) {\n    return checks[algo]\n  }\n  ZERO_BUF = ZERO_BUF || Buffer.alloc(8)\n  var prom = browserPbkdf2(ZERO_BUF, ZERO_BUF, 10, 128, algo)\n    .then(function () {\n      return true\n    }).catch(function () {\n      return false\n    })\n  checks[algo] = prom\n  return prom\n}\n\nfunction browserPbkdf2 (password, salt, iterations, length, algo) {\n  return subtle.importKey(\n    'raw', password, { name: 'PBKDF2' }, false, ['deriveBits']\n  ).then(function (key) {\n    return subtle.deriveBits({\n      name: 'PBKDF2',\n      salt: salt,\n      iterations: iterations,\n      hash: {\n        name: algo\n      }\n    }, key, length << 3)\n  }).then(function (res) {\n    return Buffer.from(res)\n  })\n}\n\nfunction resolvePromise (promise, callback) {\n  promise.then(function (out) {\n    process.nextTick(function () {\n      callback(null, out)\n    })\n  }, function (e) {\n    process.nextTick(function () {\n      callback(e)\n    })\n  })\n}\nmodule.exports = function (password, salt, iterations, keylen, digest, callback) {\n  if (typeof digest === 'function') {\n    callback = digest\n    digest = undefined\n  }\n\n  digest = digest || 'sha1'\n  var algo = toBrowser[digest.toLowerCase()]\n\n  if (!algo || typeof global.Promise !== 'function') {\n    return process.nextTick(function () {\n      var out\n      try {\n        out = sync(password, salt, iterations, keylen, digest)\n      } catch (e) {\n        return callback(e)\n      }\n      callback(null, out)\n    })\n  }\n\n  checkParameters(iterations, keylen)\n  password = toBuffer(password, defaultEncoding, 'Password')\n  salt = toBuffer(salt, defaultEncoding, 'Salt')\n  if (typeof callback !== 'function') throw new Error('No callback provided to pbkdf2')\n\n  resolvePromise(checkNative(algo).then(function (resp) {\n    if (resp) return browserPbkdf2(password, salt, iterations, keylen, algo)\n\n    return sync(password, salt, iterations, keylen, digest)\n  }), callback)\n}\n"]},"metadata":{},"sourceType":"script"}