(this.webpackJsonp=this.webpackJsonp||[]).push([[0],{429:function(e,t,n){"use strict";n(443);var r=n(756),a=n(430),i=n(0),o=n.n(i),c=n(760),s=n(35),u=i.createContext(null),l=i.createContext(null),p=n(10),f=n.n(p),d=n(18),m=n.n(d),y=n(73),v=n(190),b=n(5),g=n(51),w=n.n(g),h=n(75),x=n.n(h),E=n(87),k=function(e,t){return"web"===e?"https://cors-anywhere.herokuapp.com/"+t:t},S=function(){var e=i.useState(""),t=m()(e,2),n=t[0],r=t[1],a=i.useState(""),o=m()(a,2),c=o[0],s=o[1],u=Object(v.c)({NotoSansJP_400Regular:v.a,NotoSansJP_700Bold:v.b}),l=m()(u,1)[0];return i.useEffect((function(){!function(){var e;f.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,f.a.awrap(w.a.getItem("@private_key"));case 2:(e=t.sent)||(e=Object(E.b)(),w.a.setItem("@private_key",e)),r(e);case 5:case"end":return t.stop()}}),null,null,null,Promise)}(),function(){var e,t,n,r,a,i,o,c,u;f.a.async((function(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,f.a.awrap(y.a());case 2:if(e=l.sent){l.next=5;break}return l.abrupt("return");case 5:if(t=y.c(e),(n=t.queryParams)&&0!==Object.keys(n).length){l.next=9;break}return s("Home"),l.abrupt("return");case 9:if(!n.request_uri){l.next=31;break}return l.next=12,f.a.awrap(x.a.get(k(b.a.OS,n.request_uri)));case 12:return r=l.sent,a=r.data,i=E.c.decode(a),l.next=17,f.a.awrap(w.a.setItem("@request",JSON.stringify(i)));case 17:if("create"!==i.prompt){l.next=29;break}return l.next=20,f.a.awrap(w.a.setItem("@mode","receive"));case 20:return o=i.presentation_definition.input_descriptors[0].issuance[0].manifest,l.next=23,f.a.awrap(x.a.get(k(b.a.OS,o)));case 23:return c=l.sent,u=c.data,l.next=27,f.a.awrap(w.a.setItem("@manifest",JSON.stringify(u)));case 27:l.next=31;break;case 29:return l.next=31,f.a.awrap(w.a.setItem("@mode","present"));case 31:s("Response");case 32:case"end":return l.stop()}}),null,null,null,Promise)}()}),[]),{isFontsLoaded:l,privateKeyState:n,screenState:c}},O=function(){var e=i.useState(),t=m()(e,2),n=t[0],r=t[1];return i.useEffect((function(){!function(){var e,t;f.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,f.a.awrap(w.a.getItem("@vc"));case 2:if(e=n.sent){n.next=5;break}return n.abrupt("return");case 5:t=JSON.parse(e),r(t);case 7:case"end":return n.stop()}}),null,null,null,Promise)}()}),[]),{vcState:n}},C=n(365),P=n(757),_=n(3),j=n(46),J=n.n(j),N=function(e){return o.a.createElement(_.a,null,e.children)},T=function(e){return o.a.createElement(_.a,{style:[J()("h-full"),{backgroundColor:"#F0F0F0"}]},e.children)},K=function(e){return o.a.createElement(_.a,{style:J()("p-4")},e.children)},I=n(28),B=n(34),D=function(e){var t=e.size?e.size:"48";return o.a.createElement(_.a,{style:[J()("relative h-"+t+" rounded-lg"),{backgroundColor:e.backgroundColor}]},o.a.createElement(B.a,{style:J()("absolute left-0 top-0 m-2 w-10 h-10 rounded-full"),source:{uri:e.icon}}),o.a.createElement(I.a,{style:[J()("absolute top-0 right-0 m-4 text-lg"),{color:e.textColor}]},e.title),o.a.createElement(I.a,{style:[J()("absolute bottom-0 left-0 m-4 text-sm"),{color:e.textColor}]},e.issuedBy))},q=function(e){var t=e.navigation,n=O().vcState,r=function(e){t.navigate("Credential",{key:e})};return i.createElement(T,null,i.createElement(s.d,{centerComponent:{text:"Credentials",style:{color:"#fff"},onPress:function(){window.location.href=window.location.href.split(/[?#]/)[0],t.navigate("Home")}},rightComponent:{icon:"camera",color:"#fff",onPress:function(){t.navigate("Scanner")}}}),i.createElement(N,null,i.createElement((function(){if(n){var e=Object.keys(n).map((function(e,t){var a=n[e].card;return i.createElement(_.a,{key:e},t>0&&i.createElement(s.c,{style:J()("mx-2 my-4")}),i.createElement(D,{title:a.title,icon:a.logo.uri,issuedBy:a.issuedBy,textColor:a.textColor,backgroundColor:a.backgroundColor}),i.createElement(s.e,{onPress:function(){return r(e)},style:[J()("text-center text-xs text-blue-600 mt-4")]},"View detail"))}));return i.createElement(K,null,e)}return null}),null)))},F=n(4),R=n.n(F);function H(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function z(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?H(Object(n),!0).forEach((function(t){R()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):H(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var V=n(711),L=function(e){var t=e.navigation,n=i.useContext(u),r=function(){var e=i.useState(""),t=m()(e,2),n=t[0],r=t[1],a=i.useState(),o=m()(a,2),c=o[0],s=o[1],u=i.useState(),l=m()(u,2),p=l[0],d=l[1],v=i.useState(),b=m()(v,2),g=b[0],h=b[1],E=i.useState(""),k=m()(E,2),S=k[0],O=k[1],C=i.useState(),P=m()(C,2),_=P[0],j=P[1];return i.useEffect((function(){!function(){var e,t,n,a,i,o,c,u,l,p,m,v,b,g,E,k,S;f.a.async((function(C){for(;;)switch(C.prev=C.next){case 0:return C.next=2,f.a.awrap(y.a());case 2:if(e=C.sent){C.next=5;break}return C.abrupt("return");case 5:if(t=y.c(e),(n=t.queryParams)&&0!==Object.keys(n).length){C.next=8;break}return C.abrupt("return");case 8:return C.next=10,f.a.awrap(w.a.getItem("@manifest"));case 10:if(a=C.sent){C.next=13;break}return C.abrupt("return");case 13:if(i=JSON.parse(a),d(i),!n.code){C.next=25;break}return C.next=18,f.a.awrap(x.a.get(i.input.attestations.idTokens[0].configuration));case 18:return o=C.sent,c=o.data,C.next=22,f.a.awrap(x.a.get(c.token_endpoint+"&grant_type=authorization_code&code="+n.code));case 22:u=C.sent,l=u.data.id_token,O(l);case 25:if(!i.input.attestations.presentations){C.next=31;break}return C.next=28,f.a.awrap(x.a.get(i.input.attestations.presentations[0].contracts[0]));case 28:m=C.sent,p=m.data,h(p);case 31:return C.next=33,f.a.awrap(w.a.getItem("@mode"));case 33:if(v=C.sent){C.next=36;break}return C.abrupt("return");case 36:return r(v),C.next=39,f.a.awrap(w.a.getItem("@request"));case 39:if(b=C.sent){C.next=42;break}return C.abrupt("return");case 42:return g=JSON.parse(b),s(g),C.next=46,f.a.awrap(w.a.getItem("@vc"));case 46:(E=C.sent)&&(p||"present"===v)&&("present"===v?k=g.presentation_definition.input_descriptors[0].schema.uri[0]:"receive"===v&&(k=i.input.attestations.presentations[0].credentialType),S=JSON.parse(E),j(S[k]));case 48:case"end":return C.stop()}}),null,null,null,Promise)}()}),[]),{manifestState:p,requestState:c,modeState:n,idTokenState:S,vcState:_,presentaionManifestState:g}}(),a=r.manifestState,o=r.requestState,c=r.modeState,l=r.vcState,p=r.presentaionManifestState,d=r.idTokenState;return a&&o&&c?i.createElement(T,null,i.createElement(s.d,{leftComponent:{icon:"chevron-left",color:"#fff",onPress:function(){window.location.href=window.location.href.split(/[?#]/)[0],t.navigate("Home")}},centerComponent:{text:"receive"===c?"Receive Credentials":"Present Credentials",style:{color:"#fff"}}}),i.createElement(N,null,i.createElement((function(){return i.createElement(K,null,i.createElement(D,{title:a.display.card.title,icon:a.display.card.logo.uri,issuedBy:a.display.card.issuedBy,textColor:a.display.card.textColor,backgroundColor:a.display.card.backgroundColor}))}),null),i.createElement(s.c,null),a.input.attestations.idTokens&&"present"!==c&&i.createElement((function(){var e=a.input.attestations.idTokens[0],t=y.c(e.configuration).hostname;return i.createElement(s.b,null,i.createElement(s.b.Title,null,"Sign-in Required"),i.createElement(s.b.Divider,null),i.createElement(s.a,{type:"outline",disabled:""!==d,title:t,onPress:function(){return function(e,t){var n,r,a;return f.a.async((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,f.a.awrap(x.a.get(e));case 2:n=i.sent,r=n.data,"https://browser-wallet.azurewebsites.net/",a=r.authorization_endpoint+"&redirect_uri=https://browser-wallet.azurewebsites.net/&client_id="+t+"&response_type=code&scope=openid",y.b(a);case 7:case"end":return i.stop()}}),null,null,null,Promise)}(e.configuration,e.client_id)}}))}),null),p&&i.createElement((function(){return i.createElement(s.b,null,i.createElement(s.b.Title,null,"Credentials Required"),i.createElement(s.b.Divider,null),i.createElement(D,{title:p.display.card.title,icon:p.display.card.logo.uri,issuedBy:p.display.card.issuedBy,textColor:p.display.card.textColor,backgroundColor:p.display.card.backgroundColor,size:"40"}))}),null),i.createElement(s.a,{style:J()("m-4 mt-8"),title:"Submit",onPress:function(){var e,r,i,s,u,p,m,y,v,g;return f.a.async((function(h){for(;;)switch(h.prev=h.next){case 0:if(a.input.attestations.idTokens&&a.input.attestations.presentations?e={idTokens:R()({},a.input.attestations.idTokens[0].configuration,d),presentations:R()({},a.input.attestations.presentations[0].credentialType,l.vc)}:a.input.attestations.idTokens&&!a.input.attestations.presentations?e={idTokens:R()({},a.input.attestations.idTokens[0].configuration,d)}:!a.input.attestations.idTokens&&a.input.attestations.presentations&&(e={presentations:R()({},a.input.attestations.presentations[0].credentialType,l.vc)}),"receive"!==c){h.next=16;break}return r={aud:a.input.credentialIssuer,contract:o.presentation_definition.input_descriptors[0].issuance[0].manifest,attestations:e},i=n.siop(r),h.next=6,f.a.awrap(x.a.post(a.input.credentialIssuer,i,{headers:{"Content-Type":"text/plain"}}));case 6:return s=h.sent,h.next=9,f.a.awrap(w.a.getItem("@vc"));case 9:return(u=h.sent)&&(p=JSON.parse(u)),m=z(z({},p),{},R()({},o.presentation_definition.input_descriptors[0].schema.uri[0],{vc:s.data.vc,card:a.display.card})),h.next=14,f.a.awrap(w.a.setItem("@vc",JSON.stringify(m)));case 14:h.next=22;break;case 16:if("present"!==c){h.next=22;break}return y={presentations:R()({},o.presentation_definition.input_descriptors[0].schema.uri[0],l.vc)},v={aud:o.redirect_uri,nonce:o.nonce,state:o.state,attestations:y},g=n.siop(v),h.next=22,f.a.awrap(x.a.post(k(b.a.OS,o.redirect_uri),V.stringify({id_token:g,state:o.state}),{headers:{"Content-Type":"application/x-www-form-urlencoded"}}));case 22:window.location.href=window.location.href.split(/[?#]/)[0],t.navigate("Home");case 24:case"end":return h.stop()}}),null,null,null,Promise)}}))):null},A=function(e){var t=e.route,n=e.navigation,r=O().vcState;return i.createElement(T,null,i.createElement(s.d,{leftComponent:{icon:"chevron-left",color:"#fff",onPress:function(){n.navigate("Home")}},centerComponent:{text:"Credential Detail",style:{color:"#fff"}},rightComponent:{icon:"camera",color:"#fff",onPress:function(){n.navigate("Scanner")}}}),i.createElement(N,null,i.createElement((function(){if(r){var e=t.params.key,n=r[e],a=E.c.decode(n.vc).vc.credentialSubject;return i.createElement(i.Fragment,null,n&&i.createElement(i.Fragment,null,i.createElement(K,null,i.createElement(D,{title:n.card.title,icon:n.card.logo.uri,issuedBy:n.card.issuedBy,textColor:n.card.textColor,backgroundColor:n.card.backgroundColor})),i.createElement(s.c,null),Object.keys(a).map((function(e){return i.createElement(s.b,{key:e},i.createElement(s.e,{style:[J()("text-xm p-2")]},e+": "+a[e]))}))))}return null}),null)))},M=n(2),W=n(431),Y=n(422),G=n.n(Y),Q=function(e){var t=e.navigation;return o.a.createElement(o.a.Fragment,null,o.a.createElement(s.d,{leftComponent:{icon:"chevron-left",color:"#fff",onPress:function(){t.navigate("Home")}},centerComponent:{text:"Scan QR Code",style:{color:"#fff"}},rightComponent:{icon:"menu",color:"#fff"}}),"web"!==b.a.OS?o.a.createElement(_.a,{style:{flex:1,flexDirection:"column",justifyContent:"flex-end"}},o.a.createElement(W.a,{onBarCodeScanned:function(e){var t=e.data;console.log(t)},style:M.a.absoluteFillObject})):o.a.createElement(G.a,{onError:function(e){console.log(e)},onScan:function(e){if(e){var t=y.c(e).queryParams;t&&(window.location.href=window.location.href+"?request_uri="+t.request_uri)}}}))},$=Object(P.a)(),U=function(){var e=i.useContext(l);return i.createElement(C.a,null,i.createElement($.Navigator,{screenOptions:{headerShown:!1},initialRouteName:e},i.createElement($.Screen,{name:"Home",component:q}),i.createElement($.Screen,{name:"Response",component:L}),i.createElement($.Screen,{name:"Credential",component:A}),i.createElement($.Screen,{name:"Scanner",component:Q})))};t.a=function(){var e=S(),t=e.isFontsLoaded,n=e.privateKeyState,i=e.screenState;if(t&&n&&i){var p=new E.a(n);return console.log(p),o.a.createElement(s.f,null,o.a.createElement(u.Provider,{value:new E.a(n)},o.a.createElement(l.Provider,{value:i},o.a.createElement(c.b,null,o.a.createElement(U,null),o.a.createElement(a.a,null)))))}return o.a.createElement(r.a,null)}},441:function(e,t,n){n(442),e.exports=n(752)},442:function(e,t){"serviceWorker"in navigator&&window.addEventListener("load",(function(){navigator.serviceWorker.register("/expo-service-worker.js",{scope:"/"}).then((function(e){})).catch((function(e){console.info("Failed to register service-worker",e)}))}))},443:function(e,t,n){"use strict";(function(e){var t=n(36);e.Buffer=t.Buffer}).call(this,n(31))},606:function(e,t){},608:function(e,t){},618:function(e,t){},620:function(e,t){},647:function(e,t){},649:function(e,t){},650:function(e,t){},655:function(e,t){},657:function(e,t){},664:function(e,t){},666:function(e,t){},684:function(e,t){},687:function(e,t){},703:function(e,t){},706:function(e,t){},87:function(e,t,n){"use strict";(function(e){n.d(t,"c",(function(){return h})),n.d(t,"b",(function(){return E})),n.d(t,"a",(function(){return k}));var r=n(13),a=n.n(r),i=n(4),o=n.n(i),c=n(122),s=n.n(c);function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach((function(t){o()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var p={methodName:"ion",publicKeyType:"EcdsaSecp256k1VerificationKey2019",keyId:"signingKey"},f={header:{alg:"ES256K"},payload:{iss:"https://self-issued.me",iat:0,exp:9999999999}},d={kty:"EC",crv:"P-256K"},m={crv:"secp256k1"},y={type:"sha256",fc:18},v={pre:"-----BEGIN EC PRIVATE KEY-----\n",post:"\n-----END EC PRIVATE KEY-----"},b={pre:"302e0201010420",post:"a00706052b8104000a"},g=function(t){return e.from(t).toString("base64").replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")},w=function(t){for(t=t.replace(/-/g,"+").replace(/_/g,"/");t.length%4;)t+="=";return e.from(t,"base64").toString("utf8")},h={decode:function(e){return JSON.parse(w(e.split(".")[1]))}},x=function(t){var n=s.a.createHash(y.type).update(t).digest(),r=e.from([y.fc,n.length]);return e.concat([r,n])},E=function(){return s.a.randomBytes(32).toString("hex")},k=function t(n){var r=this;a()(this,t),this.siop=function(e){var t=s.a.randomBytes(16).toString("hex"),n={alg:f.header.alg,kid:r.did+"#"+p.keyId},a=l({iss:f.payload.iss,iat:f.payload.iat,exp:f.payload.exp,did:r.did,jti:t,sub_jwk:r.publicKeyJwk},e);return r.sign(n,a)},this.sign=function(t,n){var a=function(t){var n=""+b.pre+t+b.post,r=e.from(n,"hex").toString("base64");return""+v.pre+r+v.post}(r.privateKey),i=g(JSON.stringify(t)),o=g(JSON.stringify(n)),c=i+"."+o;return i+"."+o+"."+g(s.a.createSign(y.type).update(c).sign(a))},this.privateKey=n||E();var i=function(t){var n=e.from(t,"hex"),r=s.a.createECDH(m.crv);r.setPrivateKey(n);var a=r.getPublicKey(),i={kty:d.kty,crv:d.crv,x:g(a.slice(1,33)),y:g(a.slice(33))};return{publicKeyJwk:i,privateKeyJwk:l({d:g(n)},i)}}(this.privateKey),o=i.publicKeyJwk,c=i.privateKeyJwk;this.publicKeyJwk=o,this.privateKeyJwk=c,this.did=function(e){var t=p.keyId,n=JSON.stringify(e),r=g(x(n)),a=[{action:"replace",document:{public_keys:[{id:t,type:p.publicKeyType,jwk:e,purpose:["auth","general"]}]}}],i=JSON.stringify({update_commitment:r,patches:a}),o=g(i),c=g(x(i)),s=JSON.stringify({delta_hash:c,recovery_commitment:r}),u=g(x(s)),l=g(s);return"did:"+p.methodName+":"+u+"?-"+p.methodName+"-initial-state="+l+"."+o}(o)}}).call(this,n(36).Buffer)}},[[441,1,2]]]);
//# sourceMappingURL=app.63298378.chunk.js.map